<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRASHAST Pre-Assessment Tool - CITTAA Health Services</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        .assessment-section { 
            border-left: 4px solid #3B82F6; 
            background: linear-gradient(to right, #EBF8FF, #FFFFFF);
        }
        .response-grid {
            display: grid;
            grid-template-columns: 1fr auto auto;
            gap: 1rem;
            align-items: center;
        }
        .loading { 
            opacity: 0.7; 
            pointer-events: none; 
        }
        @media print {
            .no-print { display: none !important; }
            body { font-size: 12px; }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- Header -->
    <header class="bg-blue-600 text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <i class="fas fa-user-check text-3xl"></i>
                    <div>
                        <h1 class="text-2xl font-bold">PRASHAST Pre-Assessment Tool</h1>
                        <p class="text-blue-200">Pre-screening for Assessment of Disability - CITTAA Health Services</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-sm">Ministry of Health & Family Welfare</p>
                    <p class="text-sm">Government of India</p>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <form id="prashastForm" class="space-y-8">
            <!-- Instructions -->
            <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg">
                <div class="flex items-center">
                    <i class="fas fa-info-circle text-yellow-600 mr-2"></i>
                    <h2 class="text-lg font-semibold text-yellow-800">Instructions</h2>
                </div>
                <div class="mt-2 text-yellow-700 text-sm">
                    <p>1. Fill in student information completely</p>
                    <p>2. For each assessment item, mark ✓ for YES or ✗ for NO</p>
                    <p>3. Add observations in the Notes section</p>
                    <p>4. Items marked with * require special attention/professional consultation</p>
                    <p>5. All data will be automatically saved to Google Sheets upon submission</p>
                </div>
            </div>

            <!-- Student Information Section -->
            <div class="bg-white rounded-lg shadow-md p-6 assessment-section">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-user mr-2 text-blue-600"></i>
                    Student Information
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Name *</label>
                        <input type="text" id="studentName" required class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Class *</label>
                        <input type="text" id="studentClass" required class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Section *</label>
                        <input type="text" id="studentSection" required class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Age *</label>
                        <input type="number" id="studentAge" required class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Gender *</label>
                        <select id="studentGender" required class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="">Select Gender</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">School *</label>
                        <input type="text" id="studentSchool" required class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">State *</label>
                        <input type="text" id="studentState" required class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Mother's Name</label>
                        <input type="text" id="motherName" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Father's Name</label>
                        <input type="text" id="fatherName" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Height (cm)</label>
                        <input type="number" id="studentHeight" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Weight (kg)</label>
                        <input type="number" id="studentWeight" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
            </div>

            <!-- Part-1 Assessment -->
            <div class="bg-white rounded-lg shadow-md p-6 assessment-section">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-clipboard-check mr-2 text-green-600"></i>
                    Part-1: Disability Assessment
                </h2>
                <p class="text-gray-600 mb-6">Tick (✓) if behavior applies to the student</p>

                <!-- Locomotor Disability -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3 bg-blue-100 p-2 rounded">Locomotor Disability (LD)</h3>
                    
                    <div class="space-y-3">
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">1.1 This student has difficulty in walking or needs support to walk/climb stairs.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_1_1" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_1_1" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_1_1">
                        </div>
                        
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">1.2 This student has difficulty in moving/using any part of the body (for example hands for writing, eating, etc.).</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_1_2" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_1_2" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_1_2">
                        </div>
                        
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">1.3 This student has observable deformity such as missing any body parts, say for example hand/finger/leg.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_1_3" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_1_3" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_1_3">
                        </div>
                    </div>
                </div>

                <!-- Leprosy Cured Person -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3 bg-blue-100 p-2 rounded">Leprosy Cured Person</h3>
                    <div class="response-grid border-b pb-2">
                        <span class="text-sm">2.1 This student experiences numbness (feels nothing/lack of sensation) in hand/feet/leg/arm.</span>
                        <div class="flex space-x-2">
                            <label><input type="radio" name="item_2_1" value="✓" class="mr-1"> ✓</label>
                            <label><input type="radio" name="item_2_1" value="✗" class="mr-1"> ✗</label>
                        </div>
                        <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_2_1">
                    </div>
                </div>

                <!-- Cerebral Palsy -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3 bg-blue-100 p-2 rounded">Cerebral Palsy (CP)</h3>
                    <div class="space-y-3">
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">3.1 This student has stiffness/floppiness in limbs and/or jerky movement in limbs/jerky walking pattern/involuntary (uncontrolled) movements.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_3_1" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_3_1" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_3_1">
                        </div>
                        
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">3.2 This student has problems in self-help skills/defecating/washing/eating/holding and placing objects/cutting/pasting.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_3_2" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_3_2" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_3_2">
                        </div>
                        
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">3.3 This student has slurred (unclear) speech or drooling.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_3_3" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_3_3" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_3_3">
                        </div>
                    </div>
                </div>

                <!-- Visual Impairment -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3 bg-blue-100 p-2 rounded">Blindness</h3>
                    <div class="response-grid border-b pb-2">
                        <span class="text-sm">7.1 This student is unable to see anything using both eyes.</span>
                        <div class="flex space-x-2">
                            <label><input type="radio" name="item_7_1" value="✓" class="mr-1"> ✓</label>
                            <label><input type="radio" name="item_7_1" value="✗" class="mr-1"> ✗</label>
                        </div>
                        <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_7_1">
                    </div>
                </div>

                <!-- Low Vision -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3 bg-blue-100 p-2 rounded">Low Vision (LV)</h3>
                    <div class="space-y-3">
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">8.1 This student has difficulty in seeing in low lighting or feels the need to move towards the source of light.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_8_1" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_8_1" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_8_1">
                        </div>
                        
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">8.2 This student blinks/rubs his/her eyes frequently or complains about burning sensation or itchiness in or around the eyes/frequent headache.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_8_2" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_8_2" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_8_2">
                        </div>
                        
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">8.3 This student holds a book too far or too close while reading.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_8_3" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_8_3" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_8_3">
                        </div>
                    </div>
                </div>

                <!-- Hearing Impairment -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3 bg-blue-100 p-2 rounded">Hearing Impairment (HI)</h3>
                    <div class="space-y-3">
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">9.1 This student turns head to position ear in the direction of the speaker or purposefully watches the face of the speaker during a conversation.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_9_1" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_9_1" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_9_1">
                        </div>
                        
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">9.2 This student does not respond when addressed or called out.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_9_2" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_9_2" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_9_2">
                        </div>
                    </div>
                </div>

                <!-- Intellectual Disability -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3 bg-blue-100 p-2 rounded">Intellectual Disability (ID)</h3>
                    <div class="space-y-3">
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">11.1 This student has difficulty in communicating or socializing with others.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_11_1" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_11_1" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_11_1">
                        </div>
                        
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">11.2 This student is unable to do everyday tasks like finishing homework/following instructions/directions of the teacher or even using the washroom without help.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_11_2" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_11_2" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_11_2">
                        </div>
                    </div>
                </div>

                <!-- Specific Learning Disabilities -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3 bg-blue-100 p-2 rounded">Specific Learning Disabilities (SLD)</h3>
                    <div class="space-y-3">
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">12.1 This student reads or writes slower than the average/expected speed.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_12_1" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_12_1" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_12_1">
                        </div>
                        
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">12.2 This student has bad handwriting that lacks clarity even after sufficient practice and exercises.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_12_2" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_12_2" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_12_2">
                        </div>
                        
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">12.5 This student has a comparatively short attention span or is unable to concentrate on a task.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_12_5" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_12_5" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_12_5">
                        </div>
                    </div>
                </div>

                <!-- Autism Spectrum Disorder -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3 bg-blue-100 p-2 rounded">Autism Spectrum Disorder (ASD)</h3>
                    <div class="space-y-3">
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">13.1 This student has difficulty in making eye contact or looking at the speaker.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_13_1" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_13_1" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_13_1">
                        </div>
                        
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">13.3 This student frequently engages in repetitive play/actions. For example, spinning, flapping hands, rocking, or lining up objects.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_13_3" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_13_3" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_13_3">
                        </div>
                    </div>
                </div>

                <!-- Mental Illness -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3 bg-blue-100 p-2 rounded">Mental Illness (MI)</h3>
                    <div class="space-y-3">
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">14.1 This student often appears sad, or seems withdrawn, or has severe mood swings that cause problems in relationships at school.</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_14_1" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_14_1" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_14_1">
                        </div>
                        
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm">14.2 This student has trouble focusing or sitting still/staying in his/her seat?</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_14_2" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_14_2" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_14_2">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Part-2 Assessment -->
            <div class="bg-white rounded-lg shadow-md p-6 assessment-section">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-clipboard-list mr-2 text-red-600"></i>
                    Part-2: Additional Assessment
                </h2>
                <p class="text-gray-600 mb-6">Additional items requiring special attention (* items need professional consultation)</p>

                <!-- Mental Illness Part-2 -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3 bg-red-100 p-2 rounded">Mental Illness (MI) - Additional Items</h3>
                    <div class="space-y-3">
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm text-red-600">*14.5 Does this student indulge in self-harm activities such as making cut marks or burning fingers?</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_14_5" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_14_5" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_14_5">
                        </div>
                        
                        <div class="response-grid border-b pb-2">
                            <span class="text-sm text-red-600">*14.6 Has this student been observed to exhibit suicidal thoughts or talk about attempting suicide?</span>
                            <div class="flex space-x-2">
                                <label><input type="radio" name="item_14_6" value="✓" class="mr-1"> ✓</label>
                                <label><input type="radio" name="item_14_6" value="✗" class="mr-1"> ✗</label>
                            </div>
                            <input type="text" placeholder="Notes..." class="p-1 border rounded text-sm" name="notes_14_6">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Assessor Information -->
            <div class="bg-white rounded-lg shadow-md p-6 assessment-section">
                <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-user-tie mr-2 text-purple-600"></i>
                    Assessor Information
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Assessor Name *</label>
                        <input type="text" id="assessorName" required class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Assessment Date</label>
                        <input type="date" id="assessmentDate" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
            </div>

            <!-- Submit Section -->
            <div class="bg-white rounded-lg shadow-md p-6 text-center">
                <div class="mb-4">
                    <button type="submit" id="submitBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg transition duration-300 flex items-center justify-center mx-auto">
                        <i class="fas fa-paper-plane mr-2"></i>
                        Submit Assessment
                    </button>
                </div>
                
                <div class="text-sm text-gray-600">
                    <p>By submitting this form, the data will be automatically saved to Google Sheets.</p>
                    <p>Ensure all required fields are completed before submission.</p>
                </div>
                
                <div id="submitStatus" class="mt-4 hidden">
                    <div id="successMessage" class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded hidden">
                        <i class="fas fa-check-circle mr-2"></i>
                        Assessment submitted successfully! Data has been saved to Google Sheets.
                    </div>
                    <div id="errorMessage" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded hidden">
                        <i class="fas fa-exclamation-circle mr-2"></i>
                        <span id="errorText">Error submitting assessment. Please try again.</span>
                    </div>
                </div>
            </div>
        </form>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-6 mt-12">
        <div class="container mx-auto px-4 text-center">
            <p>&copy; 2024 CITTAA Health Services - Ministry of Health & Family Welfare, Government of India</p>
            <p class="text-sm text-gray-400 mt-2">PRASHAST Pre-Assessment Tool for Disability Screening in Schools</p>
        </div>
    </footer>

    <script>
        // Google Apps Script URL
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/a/macros/cittaa.in/s/AKfycbxWAYOh60FbqtnREpQIwXJXjEYqegP_drN7f5pfxqXXD_Qw__EbnEBX7UMrsVAPGBdBvw/exec';

        // Set current date
        document.getElementById('assessmentDate').value = new Date().toISOString().split('T')[0];

        // Form submission handler
        document.getElementById('prashastForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Validate required fields
            if (!validateForm()) {
                return;
            }

            // Show loading state
            const submitBtn = document.getElementById('submitBtn');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Submitting...';
            submitBtn.disabled = true;

            try {
                // Collect form data
                const formData = collectFormData();
                
                console.log('Submitting data:', formData);

                // Submit to Google Sheets
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                // Show success message (note: no-cors mode doesn't allow reading response)
                showMessage('success', 'Assessment submitted successfully! Data has been saved to Google Sheets.');
                
                // Reset form after successful submission
                setTimeout(() => {
                    if (confirm('Assessment submitted successfully! Would you like to start a new assessment?')) {
                        document.getElementById('prashastForm').reset();
                        document.getElementById('assessmentDate').value = new Date().toISOString().split('T')[0];
                    }
                }, 2000);

            } catch (error) {
                console.error('Submission error:', error);
                showMessage('error', 'Error submitting assessment: ' + error.message);
            } finally {
                // Restore button state
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        });

        function validateForm() {
            const required = ['studentName', 'studentClass', 'studentSection', 'studentAge', 'studentGender', 'studentSchool', 'studentState', 'assessorName'];
            
            for (let field of required) {
                const element = document.getElementById(field);
                if (!element.value.trim()) {
                    alert(`Please fill in the ${field.replace('student', '').replace('Name', ' Name').trim()} field.`);
                    element.focus();
                    return false;
                }
            }
            return true;
        }

        function collectFormData() {
            // Collect student information
            const studentInfo = {
                name: document.getElementById('studentName').value,
                class: document.getElementById('studentClass').value,
                section: document.getElementById('studentSection').value,
                age: document.getElementById('studentAge').value,
                gender: document.getElementById('studentGender').value,
                school: document.getElementById('studentSchool').value,
                state: document.getElementById('studentState').value,
                motherName: document.getElementById('motherName').value || '',
                fatherName: document.getElementById('fatherName').value || '',
                height: document.getElementById('studentHeight').value || '',
                weight: document.getElementById('studentWeight').value || ''
            };

            // Collect assessment responses
            const responses = [];
            const radioGroups = {};

            // Get all radio buttons
            const radioButtons = document.querySelectorAll('input[type="radio"]:checked');
            radioButtons.forEach(radio => {
                const name = radio.name;
                const itemMatch = name.match(/item_(\d+_\d+)/);
                if (itemMatch) {
                    const itemNo = itemMatch[1].replace('_', '.');
                    const notesField = document.querySelector(`input[name="notes_${itemMatch[1]}"]`);
                    
                    responses.push({
                        itemNo: itemNo,
                        condition: getDisabilityCondition(itemNo),
                        item: getItemText(radio),
                        response: radio.value,
                        notes: notesField ? notesField.value : ''
                    });
                }
            });

            return {
                studentInfo: studentInfo,
                responses: responses,
                assessorName: document.getElementById('assessorName').value,
                assessmentDate: document.getElementById('assessmentDate').value,
                timestamp: new Date().toISOString()
            };
        }

        function getDisabilityCondition(itemNo) {
            const conditionMap = {
                '1.1': 'Locomotor Disability (LD)', '1.2': 'LD', '1.3': 'LD',
                '2.1': 'Leprosy Cured Person',
                '3.1': 'Cerebral Palsy (CP)', '3.2': 'CP', '3.3': 'CP',
                '7.1': 'Blindness',
                '8.1': 'Low Vision (LV)', '8.2': 'LV', '8.3': 'LV',
                '9.1': 'Hearing Impairment (HI)', '9.2': 'HI',
                '11.1': 'Intellectual Disability (ID)', '11.2': 'ID',
                '12.1': 'Specific Learning Disabilities (SLD)', '12.2': 'SLD', '12.5': 'SLD',
                '13.1': 'Autism Spectrum Disorder (ASD)', '13.3': 'ASD',
                '14.1': 'Mental Illness (MI)', '14.2': 'MI', '14.5': 'MI', '14.6': 'MI'
            };
            return conditionMap[itemNo] || 'Unknown';
        }

        function getItemText(radioElement) {
            const container = radioElement.closest('.response-grid');
            if (container) {
                const textSpan = container.querySelector('span');
                return textSpan ? textSpan.textContent.trim() : '';
            }
            return '';
        }

        function showMessage(type, text) {
            const statusDiv = document.getElementById('submitStatus');
            const successDiv = document.getElementById('successMessage');
            const errorDiv = document.getElementById('errorMessage');
            
            statusDiv.classList.remove('hidden');
            
            if (type === 'success') {
                successDiv.classList.remove('hidden');
                errorDiv.classList.add('hidden');
            } else {
                errorDiv.classList.remove('hidden');
                successDiv.classList.add('hidden');
                document.getElementById('errorText').textContent = text;
            }
            
            // Hide message after 5 seconds
            setTimeout(() => {
                statusDiv.classList.add('hidden');
                successDiv.classList.add('hidden');
                errorDiv.classList.add('hidden');
            }, 5000);
        }

        // Auto-save progress to localStorage
        setInterval(() => {
            const formData = new FormData(document.getElementById('prashastForm'));
            const data = {};
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            localStorage.setItem('prashastProgress', JSON.stringify(data));
        }, 30000); // Save every 30 seconds

        // Load saved progress
        window.addEventListener('load', () => {
            const saved = localStorage.getItem('prashastProgress');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    Object.keys(data).forEach(key => {
                        const element = document.querySelector(`[name="${key}"]`);
                        if (element) {
                            if (element.type === 'radio') {
                                const radio = document.querySelector(`[name="${key}"][value="${data[key]}"]`);
                                if (radio) radio.checked = true;
                            } else {
                                element.value = data[key];
                            }
                        }
                    });
                } catch (e) {
                    console.log('Could not restore saved progress');
                }
            }
        });

        // Print functionality
        function printAssessment() {
            window.print();
        }

        // Add print button
        const printBtn = document.createElement('button');
        printBtn.innerHTML = '<i class="fas fa-print mr-2"></i>Print Assessment';
        printBtn.className = 'bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded ml-4 no-print';
        printBtn.type = 'button';
        printBtn.onclick = printAssessment;
        document.querySelector('.text-center').appendChild(printBtn);
    </script>
</body>
</html>
